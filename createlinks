#!/usr/bin/perl -w

use strict;
use esmith::Build::CreateLinks qw(:all);

foreach (qw(
    /etc/ssh/sshd_config
	))
{
    templates2events("$_", qw(
	console-save
	bootstrap-console-save
	remoteaccess-update
	));
}

foreach (qw(
    /etc/rssh.conf
	))
{
    templates2events("$_", qw(
	bootstrap-console-save
	password-modify
	remoteaccess-update
	user-lock
	user-create
	user-delete
	user-modify
	));
}

foreach my $event (
    "console-save",
    "bootstrap-console-save",
    "remoteaccess-update")
{
    event_link("sshd-conf", $event, "65");
}

foreach my $event (
    "console-save",
    "remoteaccess-update")
{
    safe_symlink("sighup", "root/etc/e-smith/events/$event/services2adjust/sshd");
}

# Set up links to daemontools. Note: /etc/init.d/sshd is now obsolete.
                                                                                    
service_link_enhanced("sshd", "S85", "7");

#
# Actions for nethserver-openssh-update event
#

my $event = "nethserver-openssh-update";
templates2events("/etc/hosts.allow",$event);
templates2events("/etc/rssh.conf",$event);
templates2events("/etc/ssh/sshd_config",$event);
event_link("sshd-conf", $event, "65");
safe_symlink("sighup", "root/etc/e-smith/events/$event/services2adjust/sshd");
